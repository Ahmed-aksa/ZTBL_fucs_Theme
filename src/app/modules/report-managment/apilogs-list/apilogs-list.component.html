<<<<<<< HEAD
<div class="px-10 pt-4 sm:absolute sm:inset-0 flex flex-col flex-auto min-w-0 sm:overflow-hidden bg-card dark:bg-transparent">
    <div class="text-3xl mt-4  font-extrabold tracking-tight pb-2 border-b mb-2 border-green-500 p-2" style="background-color: #f6fcf8;">API Logs</div>
=======
<div
    class="px-10 pt-4 sm:absolute sm:inset-0 flex flex-col flex-auto min-w-0 sm:overflow-hidden bg-card dark:bg-transparent">
    <div class="text-4xl font-extrabold tracking-tight">API Logs</div>
>>>>>>> 889505556f501ee4ef1e36a137c1085114e0e35e
    <!-- Header -->
    <div class="py-4" [formGroup]="FilterForm">


        <div class="row">
            <div class="col-lg-4 col-sm-12">
                <div class="flex flex-shrink-0 items-center mt-6 sm:mt-0 ">
                    <mat-form-field class="w-full" appearance="outline">
                        <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Search"
                               autocomplete="off"
                               appearance="outline">
                        <mat-hint align="start"><strong>Search</strong> in all fields</mat-hint>
                    </mat-form-field>
                </div>
            </div>
            <div class="col-lg-4 col-sm-12">
                <div class="flex flex-shrink-0 items-center mt-6 sm:mt-0 sm:ml-4">
                    <mat-form-field class="mat-form-field-fluid  w-full" appearance="outline">
                        <mat-label>Choose start date</mat-label>
                        <input matInput [matDatepicker]="picker1" formControlName="StartDate"
                               (dateChange)="comparisonStartdateValidator()" autocomplete="off">

                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>

                        <mat-datepicker #picker1></mat-datepicker>

                        <mat-error *ngIf="FilterForm.controls['StartDate'].hasError('invaliddaterange')">
                            <strong>Start date cannot be greater than end date</strong>
                        </mat-error>
                        <mat-error *ngIf="hasError('StartDate', 'required')">Start Date <strong>required</strong>
                        </mat-error>

                    </mat-form-field>
                </div>
            </div>
            <div class="col-lg-4 col-sm-12">
                <div class="flex flex-shrink-0 items-center mt-6 sm:mt-0 sm:ml-4">
                    <mat-form-field class="mat-form-field-fluid w-full" appearance="outline">
                        <mat-label>Choose end date</mat-label>
                        <input matInput [matDatepicker]="picker" formControlName="EndDate"
                               (dateChange)="comparisonEnddateValidator()" autocomplete="off">

                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>

                        <mat-error *ngIf="FilterForm.controls['EndDate'].hasError('invaliddaterange')">
                            <strong>End date cannot be earlier than start date</strong>
                        </mat-error>

                        <mat-error *ngIf="hasError('EndDate', 'required')">End Date <strong>required</strong>
                        </mat-error>
                    </mat-form-field>
                </div>
            </div>

        </div>
        <div class="row pb-2">
            <div class="col-lg-4 col-sm-12">
                <div class="flex flex-shrink-0 items-center mt-6 sm:mt-0">
                    <button mat-raised-button class="mat-focus-indicator mat-flat-button mat-button-base mat-primary"
                            type="button" (click)="loadApiLogs()">
                        <mat-icon class="mr-2">search</mat-icon>
                        Search
                    </button>
                </div>
            </div>
        </div>


    </div>

    <section matSort class="mat-elevation-z2 mat-header-row">
        <span class="mat-header-cell" mat-sort-header="Id" style="width: 10px;">ID</span>
        <span class="mat-header-cell" mat-sort-header="TransactionId">Transaction ID</span>
        <span class="mat-header-cell" mat-sort-header="ApiName">API Name</span>
        <span class="mat-header-cell" mat-sort-header="CallDateTime">Call Date Time</span>
        <span class="mat-header-cell" mat-sort-header="ResponseDateTime">Response Date Time</span>
        <span class="mat-header-cell" mat-sort-header="ResponseTotalTime">Total Time Taken</span>
        <span class="mat-header-cell" mat-sort-header="View">View</span>
    </section>
    <mat-accordion displayMode="flat" multi class="mat-table" style="overflow-y:scroll;">


        <mat-expansion-panel class="api-table shadow-none mb-4 p-0" *ngFor="let item of displayedRows$ |async"
                             (click)="fetch3rdAPI($event,item)" style="box-shadow: none !important; margin-bottom: 5px !important;">
            <mat-expansion-panel-header class="mat-row custom-accordion py-2 h-16  rounded-lg my-1 shadow border">
                <span class="mat-cell py-6 self-center" style="width: 10px;">{{item?.Id}}</span>
                <span class="mat-cell py-6 self-center">{{item?.TransactionId}}</span>
                <span class="mat-cell py-6 self-center">{{item?.APIName}}</span>
                <span class="mat-cell py-6 self-center px-2">{{item?.CallDateTime}}</span>
                <span class="mat-cell py-6 self-center px-2">{{item?.ResponseDateTime}}</span>
                <span class="mat-cell py-6 self-center px-2 ">{{item?.TotalTimeTaken}}</span>
                <span class="mat-cell py-6 self-center">
                    <button mat-icon-button color="primary" (click)="viewRequestResponse($event,item)">
                                            <mat-icon title="View">visibility</mat-icon>
                                        </button>
                </span>
            </mat-expansion-panel-header>
<<<<<<< HEAD
            <div *ngFor="let tp_item of third_party_apis" class="p-0">
                <div class="custom-accordion-body  bg-gray-50 border  border-b-0 rounded p-0">
=======
            <div *ngFor="let tp_item of item?.third_apis">
                <div class="custom-accordion-body">
>>>>>>> 889505556f501ee4ef1e36a137c1085114e0e35e
                    <table class="table table-responsive" style="display: inline-table !important;">
                        <thead class="thead-light">
                        <tr>
                            <th>ID</th>
                            <th>Transaction ID</th>
                            <th>API Name</th>
                            <th>Call Date Time</th>
                            <th>Response Date Time</th>
                            <th>Total Time Taken</th>
                            <th>Action</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>{{tp_item?.Id}}</td>
                            <td>{{tp_item?.TransactionId}}</td>
                            <td>{{tp_item?.APIName}}</td>
                            <td>{{tp_item?.CallDateTime}}</td>
                            <td>{{tp_item?.ResponseDateTime}}</td>
                            <td>{{tp_item?.TotalTimeTaken}}</td>
                            <td>
                                <button mat-icon-button color="primary"
                                        (click)="viewRequestResponse($event,tp_item,true)">
                                    <mat-icon title="View">visibility</mat-icon>
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
                </div>
            </div>
        </mat-expansion-panel>

    </mat-accordion>

    <mat-paginator #paginator
                   [length]="totalRows$ | async"
                   [pageIndex]="0"
                   [pageSize]="10"
                   [pageSizeOptions]="[5, 10, 25, 100]"
    ></mat-paginator>
</div>
</div>

