<form [formGroup]="purposeForm" class="kt-form kt-form--group-seperator-dashed">
    <div class="kt-form">
        <div class="kt-portlet__body">

            <div class="form-group kt-form__group row">
                <div class="col-lg-4 col-sm-12">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-6/12">
                        <mat-label class="customMatLabel">GL Code <strong class="matMandatory">*</strong></mat-label>
                        <input appNumberOnly formControlName="GlSubID" matInput placeholder="Enter GL Code"/>
                        <mat-error *ngIf="hasError('GlSubID', 'required')">GL Code <strong>required</strong></mat-error>
                    </mat-form-field>
                    <button (click)="GlschemeCropConfiguration()" *ngIf="currentActivity.C" class=" w-5/12 ml-1 btn btn-primary"
                            color="primary"
                            mat-raised-button type="button">
                        Get GL Code #
                    </button>
                </div>


                <div class="col-lg-4 col-sm-12 ">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Scheme Code <strong class="matMandatory"></strong></mat-label>
                        <input appNumberOnly formControlName="SchemeID" matInput placeholder="Scheme Code"/>
                        <!--<mat-error *ngIf="hasError('DevAmount', 'required')">GL Code <strong>required</strong></mat-error>-->
                    </mat-form-field>
                </div>
                <div class="col-lg-4 col-sm-12 ">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Markup Calc Mode <strong class="matMandatory">*</strong>
                        </mat-label>
                        <mat-select [disabled]="MarkupCalcReadOnly" formControlName="MarkupCalcMode">
                            <mat-option *ngFor="let markup of MarkupCalcMode" [value]="markup.Id">
                                {{markup.Name }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="hasError('MarkupCalcMode', 'required')">Markup Calc Mode
                            <strong>required</strong></mat-error>
                    </mat-form-field>
                </div>

            </div>

            <div class="form-group kt-form__group row">
                <div class="col-lg-4 col-sm-12 kt-margin-bottom-20-mobile">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Crop Code<strong class="matMandatory"></strong></mat-label>
                        <input appNumberOnly formControlName="CropID" matInput placeholder="Enter Crop Code"/>
                    </mat-form-field>
                </div>
                <div class="col-lg-4 col-sm-12 kt-margin-bottom-20-mobile">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Cultivated Area(Marla) <strong class="matMandatory"></strong>
                        </mat-label>
                        <input appNumberOnly formControlName="CultivatedArea" matInput
                               placeholder="Cultivated Area(Marla)"/>
                    </mat-form-field>
                </div>
                <div class="col-lg-4 col-sm-12 kt-margin-bottom-20-mobile">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Make/Capacity <strong class="matMandatory"></strong>
                        </mat-label>
                        <mat-select formControlName="RequiredItem">
                            <mat-option>
                                <ngx-mat-select-search (focusout)="validateCapacityOnFocusOut()"
                                                       (keyup)="searchCapacity($event.target.value)"
                                                       noEntriesFoundLabel="No Capacity Found"
                                                       placeholderLabel="Search Capacity...">
                                </ngx-mat-select-search>
                            </mat-option>
                            <mat-option *ngFor="let Capacity of MakeCapacitySelected" [value]="Capacity.Id">
                                {{Capacity.Name }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

            </div>

            <div class="form-group kt-form__group row">
                <div class="col-lg-4 col-sm-12 kt-margin-bottom-20-mobile">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Quantity <strong class="matMandatory"></strong></mat-label>
                        <input appNumberOnly formControlName="Quantity" matInput
                               maxlength="4"
                               placeholder="Enter Production Loan Amount"/>
                    </mat-form-field>
                </div>
                <div class="col-lg-4 col-sm-12 kt-margin-bottom-20-mobile">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Facility <strong class="matMandatory"></strong></mat-label>
                        <mat-select formControlName="FundNonFund">
                            <mat-option *ngFor="let facility of Facility" [value]="facility.Id">
                                {{facility.Name }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="col-lg-4 col-sm-12 kt-margin-bottom-20-mobile">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Market Price <strong class="matMandatory">*</strong>
                        </mat-label>
                        <input appNumberOnly formControlName="TotalEstimatedCost" matInput
                               maxlength="9" placeholder="Enter Market Price"/>
                        <mat-error *ngIf="hasError('TotalEstimatedCost', 'required')">Market Price
                            <strong>required</strong></mat-error>
                    </mat-form-field>
                </div>

            </div>

            <div class="form-group kt-form__group row">
                <div class="col-lg-4 col-sm-12 kt-margin-bottom-20-mobile">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Equity (Rs.) <strong class="matMandatory"></strong>
                        </mat-label>
                        <input appNumberOnly formControlName="AmountInHand" matInput maxlength="9"
                               placeholder="Enter Market Price"/>
                    </mat-form-field>
                </div>
                <div class="col-lg-4 col-sm-12">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Loan Applied (Rs.) <strong class="matMandatory">*</strong>
                        </mat-label>
                        <input appNumberOnly formControlName="AmountRequired" matInput maxlength="9"
                               placeholder="Enter Market Price"/>
                        <mat-error *ngIf="hasError('AmountRequired', 'required')">Loan Applied <strong>required</strong>
                        </mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="form-group kt-form__group row">
                <div class="col-lg-4 col-sm-12 kt-margin-bottom-20-mobile mt-2">
                    <mat-checkbox (change)="isCheckedEquity = !isCheckedEquity" [checked]="isCheckedEquity"
                                  class="example-margin">Check Equity
                    </mat-checkbox>
                </div>
                <div class="col-lg-8 col-sm-12 kt-margin-bottom-20-mobile">
                    <mat-label class="customMatLabel mb-4"><b>Borrower Agreed to Pay Insurance For (Opt)
                        Crops</b><strong class="matMandatory">*</strong></mat-label>
                    &nbsp;
                    <label>
                        <input formControlName="BwrAgreeInsurancePrem" type="radio" value="Y">
                        <span>Yes</span>
                    </label>
                    <label>
                        <input formControlName="BwrAgreeInsurancePrem" type="radio" value="N">
                        <span>No</span>
                    </label>
                </div>
            </div>
            <div class="form-group kt-form__group row mt-2">
                <div class="col-lg-12 kt-margin-bottom-20-mobile">
                    <mat-form-field appearance="outline" class="mat-form-field-fluid w-full">
                        <mat-label class="customMatLabel">Remarks <strong class="matMandatory">*</strong></mat-label>
                        <!--<input matInput placeholder="Enter Market Price" formControlName="NecessitiesDetail"/>-->
                        <textarea formControlName="NecessitiesDetail" matInput
                                  placeholder="Enter Market Price"></textarea>
                        <mat-error *ngIf="hasError('NecessitiesDetail', 'required')">Remarks <strong>required</strong>
                        </mat-error>
                    </mat-form-field>
                </div>

            </div>
            <div class="form-group kt-form__group row pb-2">
                <div class="col-lg-12 mt-1p">
                    <button (click)="onSavePurpose()" *ngIf="currentActivity.C" class="btn btn-primary" color="primary"
                            mat-raised-button style="background-color: #01671B;" type="button">
                        <mat-icon class="mr-2">save</mat-icon>
                        Save
                    </button>
                    <button (click)="onClearSavePurpose()"
                            *ngIf="currentActivity.C"
                            class="mat-focus-indicator  btn bg-red-500 text-white rounded-md mx-2 mat-raised-button mat-button-base mat-danger" color="danger" type="button">
                        <mat-icon class="mr-2"> clear_all</mat-icon>
                        Clear
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>


<div class="form-group kt-form__group row">
    <div class="col-lg-12">
        <div class="table-responsive">
            <table *ngIf="loanPurpose.length != 0" class="table table-striped">
                <thead>
                <tr class="table-header-background">
                    <th>GL Code</th>
                    <th>Scheme Code</th>
                    <th>Crop</th>
                    <th>Crop Code</th>
                    <th>Caltivated Area(Marla)</th>
                    <th>Quantity</th>
                    <th>Market Price</th>
                    <th>Equity(Rs.)</th>
                    <th>Loan Applied(Rs.)</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody class="">
                <tr *ngFor="let loan of loanPurpose; let i = index;">
                    <td>{{loan.GlSubID}}</td>
                    <td>{{loan.SchemeID}}</td>
                    <td>{{loan.CropID}}</td>
                    <td>{{loan.CropName}}</td>
                    <td>{{loan.CultivatedArea}}</td>
                    <td>{{loan.Quantity}}</td>
                    <td>{{loan.TotalEstimatedCost}}</td>
                    <td>{{loan.AmountInHand}}</td>
                    <td>{{loan.AmountRequired}}</td>
                    <td>


                        <mat-icon (click)="onEditPurpose(loan)" *ngIf="currentActivity.U"
                                  class="cursor-pointer text-green">edit
                        </mat-icon>
                        <mat-icon (click)="onDeletePurpose(loan,i)" *ngIf="currentActivity.D"
                                  class="cursor-pointer text-red-500 ml-3">delete
                        </mat-icon>

                        <!-- <span (click)="onEditPurpose(loan)"
                              style="cursor: pointer;
                                color: #ecbd00;font-size: 16px;">Edit</span> | -->

                        <!-- <span style="cursor: pointer; color: #ecbd00;font-size: 16px;"
                        (click)="onDeletePurpose(loan,i)">Delete</span> -->


                    </td>


                </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>


<!-- <ngx-spinner bdColor="rgba(51,51,51,0.8)"
             size="medium"
             color="#ecbd00"
             type="ball-scale-multiple">
  <p style="font-size: 20px; color: white">Loading...</p>
</ngx-spinner> -->

